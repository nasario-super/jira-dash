var g=Object.defineProperty;var y=(d,e,i)=>e in d?g(d,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[e]=i;var u=(d,e,i)=>(y(d,typeof e!="symbol"?e+"":e,i),i);const r=class r{static getInstance(){return r.instance||(r.instance=new r),r.instance}async generateInsights(e,i,a="month"){console.log("🤖 AI Insights: Gerando análises automáticas...");const t=[];try{const s=await this.analyzePerformance(e,i,a);t.push(...s);const n=await this.analyzeTrends(e,a);t.push(...n);const o=await this.detectAnomalies(e,a);t.push(...o);const c=await this.assessRisks(e,i);t.push(...c);const p=await this.generateRecommendations(e,i);return t.push(...p),t.sort((l,m)=>l.priority!==m.priority?m.priority-l.priority:m.confidence-l.confidence),console.log(`✅ AI Insights: ${t.length} insights gerados`),t}catch(s){return console.error("❌ AI Insights Error:",s),[]}}async analyzePerformance(e,i,a){const t=[];e.filter(c=>c.fields.status.statusCategory.name==="Done");const s=this.calculateVelocity(e,i),n=this.calculateCycleTime(e),o=this.calculateBugRate(e);return this.calculateReworkRate(e),s<10&&t.push({id:"low-velocity",type:"performance",title:"Velocidade Baixa Detectada",description:`A velocidade da equipe está em ${s.toFixed(1)} pontos/sprint, considerada baixa para o tamanho da equipe.`,confidence:85,impact:"high",category:"Performance",metrics:{velocity:s,threshold:15},recommendations:["Revisar estimativas de story points","Identificar gargalos no processo","Considerar pair programming","Avaliar complexidade das tarefas"],timestamp:new Date,priority:8}),n>14&&t.push({id:"high-cycle-time",type:"performance",title:"Tempo de Ciclo Elevado",description:`O tempo médio de ciclo está em ${n.toFixed(1)} dias, acima do ideal de 7-10 dias.`,confidence:90,impact:"high",category:"Performance",metrics:{cycleTime:n,ideal:10},recommendations:["Implementar WIP limits","Revisar processo de review","Automatizar testes","Melhorar comunicação entre equipes"],timestamp:new Date,priority:9}),o>.3&&t.push({id:"high-bug-rate",type:"performance",title:"Taxa de Bugs Elevada",description:`A taxa de bugs está em ${(o*100).toFixed(1)}%, considerada alta.`,confidence:80,impact:"medium",category:"Quality",metrics:{bugRate:o,threshold:.2},recommendations:["Implementar testes automatizados","Revisar processo de QA","Melhorar definição de critérios de aceite","Investigar causas raiz dos bugs"],timestamp:new Date,priority:7}),t}async analyzeTrends(e,i){const a=[],t=this.analyzeVelocityTrend(e,i);t.trend==="decreasing"&&t.significance>70&&a.push({id:"velocity-decline",type:"trend",title:"Declínio na Velocidade",description:`A velocidade da equipe está diminuindo consistentemente (${t.changeRate.toFixed(1)}% por ${i}).`,confidence:t.significance,impact:"high",category:"Trends",metrics:t,recommendations:["Investigar causas do declínio","Revisar carga de trabalho","Avaliar burnout da equipe","Implementar retrospectivas mais frequentes"],timestamp:new Date,priority:9});const s=this.analyzeCompletionTrend(e,i);return s.trend==="decreasing"&&s.significance>60&&a.push({id:"completion-decline",type:"trend",title:"Redução na Taxa de Conclusão",description:`A taxa de conclusão de issues está diminuindo (${s.changeRate.toFixed(1)}% por ${i}).`,confidence:s.significance,impact:"medium",category:"Trends",metrics:s,recommendations:['Revisar definição de "Done"',"Avaliar complexidade das tarefas","Melhorar planejamento de sprint","Identificar dependências externas"],timestamp:new Date,priority:6}),a}async detectAnomalies(e,i){const a=[],t=this.detectVelocityAnomalies(e,i);a.push(...t);const s=this.detectBugAnomalies(e,i);a.push(...s);const n=this.detectCompletionAnomalies(e,i);return a.push(...n),a}async assessRisks(e,i){const a=[],t=e.filter(n=>n.fields.duedate?new Date(n.fields.duedate)<new Date:!1);t.length>0&&a.push({id:"overdue-issues",type:"risk",title:"Issues Atrasadas",description:`${t.length} issues estão atrasadas, representando risco para o cronograma.`,confidence:95,impact:"high",category:"Risks",metrics:{overdueCount:t.length,totalIssues:e.length},recommendations:["Priorizar issues atrasadas","Revisar estimativas de prazo","Comunicar impactos aos stakeholders","Implementar buffer de tempo"],timestamp:new Date,priority:10});const s=e.filter(n=>n.fields.priority.name==="High"&&!n.fields.assignee);return s.length>0&&a.push({id:"unassigned-high-priority",type:"risk",title:"Issues de Alta Prioridade Sem Assignee",description:`${s.length} issues de alta prioridade não possuem responsável atribuído.`,confidence:90,impact:"medium",category:"Risks",metrics:{unassignedCount:s.length},recommendations:["Atribuir responsáveis imediatamente","Revisar processo de atribuição","Implementar alertas automáticos","Criar SLA para atribuição"],timestamp:new Date,priority:8}),a}async generateRecommendations(e,i){const a=[],t=this.analyzeProcess(e,i);a.push(...t);const s=this.analyzeEfficiency(e,i);return a.push(...s),a}calculateVelocity(e,i){console.log("🔍 AI Insights - calculateVelocity Debug:",{totalIssues:e.length,totalSprints:i.length,issuesSample:e.slice(0,3).map(n=>({key:n.key,status:n.fields.status.name,statusCategory:n.fields.status.statusCategory.name,type:n.fields.issuetype.name}))});const a=e.filter(n=>n.fields.status.statusCategory.name==="Done");console.log("🔍 AI Insights - completedIssues:",{completedCount:a.length,completedSample:a.slice(0,3).map(n=>({key:n.key,status:n.fields.status.name,type:n.fields.issuetype.name}))});const t=a.reduce((n,o)=>{const c=o.fields.issuetype.name;return n+(c==="Story"?3:c==="Task"?2:c==="Bug"?1:5)},0),s=i.length>0?t/i.length:0;return console.log("🔍 AI Insights - velocity calculation:",{totalPoints:t,sprintsLength:i.length,velocity:s}),s}calculateCycleTime(e){const i=e.filter(t=>t.fields.status.statusCategory.name==="Done");return i.length===0?0:i.reduce((t,s)=>{const n=new Date(s.fields.created),o=new Date(s.fields.updated);return t+(o.getTime()-n.getTime())},0)/i.length/(1e3*60*60*24)}calculateBugRate(e){const i=e.length,a=e.filter(t=>t.fields.issuetype.name==="Bug");return i>0?a.length/i:0}calculateReworkRate(e){const i=e.filter(a=>a.fields.updated!==a.fields.created);return e.length>0?i.length/e.length:0}analyzeVelocityTrend(e,i){const a=this.getRecentIssues(e,i),t=this.getOlderIssues(e,i),s=this.calculateVelocity(a,[]),n=this.calculateVelocity(t,[]),o=n>0?(s-n)/n*100:0;return{metric:"velocity",period:i,trend:o>10?"increasing":o<-10?"decreasing":"stable",changeRate:o,significance:Math.abs(o),dataPoints:[]}}analyzeCompletionTrend(e,i){const a=this.getRecentIssues(e,i),t=this.getOlderIssues(e,i),s=a.filter(c=>c.fields.status.statusCategory.name==="Done").length/a.length,n=t.filter(c=>c.fields.status.statusCategory.name==="Done").length/t.length,o=n>0?(s-n)/n*100:0;return{metric:"completion",period:i,trend:o>10?"increasing":o<-10?"decreasing":"stable",changeRate:o,significance:Math.abs(o),dataPoints:[]}}detectVelocityAnomalies(e,i){const a=[],t=this.calculateVelocity(e,[]),s=15;return t>s*1.5&&a.push({id:"velocity-spike",type:"anomaly",title:"Pico de Velocidade Detectado",description:`A velocidade atual (${t.toFixed(1)}) está ${((t-s)/s*100).toFixed(1)}% acima do esperado.`,confidence:75,impact:"low",category:"Anomaly",metrics:{velocity:t,expected:s},recommendations:["Verificar se as estimativas estão corretas","Avaliar se há trabalho extra não contabilizado","Documentar práticas que levaram ao aumento"],timestamp:new Date,priority:3}),a}detectBugAnomalies(e,i){const a=[],t=this.getRecentIssues(e,i),s=this.calculateBugRate(t);return s>.4&&a.push({id:"bug-spike",type:"anomaly",title:"Pico de Bugs Detectado",description:`A taxa de bugs está em ${(s*100).toFixed(1)}%, significativamente acima do normal.`,confidence:85,impact:"high",category:"Anomaly",metrics:{bugRate:s,threshold:.2},recommendations:["Investigar causa raiz do aumento","Revisar processo de QA","Implementar testes adicionais","Comunicar com a equipe de desenvolvimento"],timestamp:new Date,priority:8}),a}detectCompletionAnomalies(e,i){const a=[],t=this.getRecentIssues(e,i),s=t.filter(n=>n.fields.status.statusCategory.name==="Done").length/t.length;return s<.3&&a.push({id:"completion-drop",type:"anomaly",title:"Queda na Taxa de Conclusão",description:`A taxa de conclusão está em ${(s*100).toFixed(1)}%, abaixo do esperado.`,confidence:80,impact:"medium",category:"Anomaly",metrics:{completionRate:s,threshold:.5},recommendations:["Identificar bloqueios nas tarefas",'Revisar definição de "Done"',"Avaliar carga de trabalho da equipe","Implementar daily standups mais eficazes"],timestamp:new Date,priority:6}),a}analyzeProcess(e,i){const a=[],t=this.calculateCycleTime(e);return this.calculateReworkRate(e),t>21&&a.push({id:"process-inefficiency",type:"recommendation",title:"Processo Ineficiente Detectado",description:`O tempo de ciclo médio está em ${t.toFixed(1)} dias, indicando ineficiência no processo.`,confidence:90,impact:"high",category:"Process",metrics:{cycleTime:t,ideal:14},recommendations:["Implementar Kanban com WIP limits","Revisar processo de aprovação","Automatizar testes e deploy","Melhorar comunicação entre equipes"],timestamp:new Date,priority:9}),a}analyzeEfficiency(e,i){const a=[],t=this.calculateVelocity(e,i),s=this.calculateBugRate(e);return t>0&&s<.1&&a.push({id:"high-efficiency",type:"recommendation",title:"Equipe de Alta Eficiência",description:"A equipe está demonstrando alta eficiência com boa velocidade e baixa taxa de bugs.",confidence:85,impact:"low",category:"Efficiency",metrics:{velocity:t,bugRate:s},recommendations:["Documentar práticas de sucesso","Compartilhar conhecimento com outras equipes","Considerar aumentar a complexidade dos projetos","Manter o ritmo atual"],timestamp:new Date,priority:2}),a}getRecentIssues(e,i){const a=new Date,t=i==="week"?7:i==="month"?30:90,s=new Date(a.getTime()-t*24*60*60*1e3);return e.filter(n=>new Date(n.fields.created)>=s)}getOlderIssues(e,i){const a=new Date,t=i==="week"?14:i==="month"?60:180,s=new Date(a.getTime()-t*24*60*60*1e3);return e.filter(n=>{const o=new Date(n.fields.created);return o<s&&o>=new Date(a.getTime()-t*2*24*60*60*1e3)})}};u(r,"instance");let h=r;export{h as AIInsightsService,h as default};
//# sourceMappingURL=aiInsightsService-c5fbee27.js.map
